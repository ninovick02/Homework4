---
title: "Combining Excel and Delimited Data"
format: html
toc: TRUE
editor_options: 
  chunk_output_type: console
---

## Task 3: Combining Excel and Delimited Data

Load tidyverse
```{r}
library(tidyverse)
```

### Excel file 

Import data from project directory
```{r}
white_wine_tbl <- read_excel("../white-wine.xlsx", sheet = "white-wine")

white_wine_tbl
```

Import variable names from sheet 2 on same excel file
```{r}
wine_vars <- readxl::read_excel("../white-wine.xlsx", sheet = "variables")
```

Overwrite non-standard column names with variables from sheet 2
*The variables are in a tibble, so you need to strip it to use the values*
```{r}
colnames(white_wine_tbl) = wine_vars[[1]]
```

Add a column that adds wine type (all white)
```{r}
white_wine_tbl$wine_type = "white"
```

### Semi-colon delimited
Import data from project directory
```{r}
red_wine_tbl <- readr::read_csv2("../red-wine.csv") 

red_wine_tbl <- red_wine_tbl |> 
  mutate(across(where(is.character), as.numeric))

colnames(red_wine_tbl) = wine_vars[[1]]

red_wine_tbl$wine_type = "red"
```

Combine two data sets into one
```{r}
all_wines <- dplyr::bind_rows(white_wine_tbl, red_wine_tbl)
```


Filter data
```{r}
good_wines <- all_wines |> 
  filter(quality > 6.5 & alcohol < 132) |> 
  arrange(desc(quality)) |> 
  select(contains("acid"), alcohol, wine_type, quality) |> 
  group_by(quality) |> 
  mutate(across(alcohol, list(mean = mean, sd = sd), .names = "{.col}_{.fn}"), 
  )
```


